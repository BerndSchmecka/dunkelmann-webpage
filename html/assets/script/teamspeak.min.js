/*! *****************************************************************************
Copyright (c) Dunkelmann 2022. All rights reserved.

This code is licensed under the BSD License
You should have received a copy of the BSD License
with this code and it is also available through
the world-wide-web at <https://files.dunkelmann.eu/license.txt>.
If you did not receive a copy of the BSD License
and are unable to obtain it through the world-wide-web,
please send a note to <business@dunkelmann.eu> so we can mail you a copy
immediately.
***************************************************************************** */
let STABLE_URL="aHR0cHM6Ly90ZWFtc3BlYWsuY29tL2VuL2Rvd25sb2Fkcy8jY2xpZW50",SERVER_URL="aHR0cHM6Ly90ZWFtc3BlYWsuY29tL2VuL2Rvd25sb2Fkcy8jc2VydmVy",BETA_URL="",ALPHA_URL="",TS5_URL="aHR0cHM6Ly93d3cudGVhbXNwZWFrLmNvbS9kZS9kb3dubG9hZHMvI3RzNQ==";function receiveMessage(e){if("https://www.dunkelmann.eu"===e.origin){var t=JSON.parse(e.data);"resize"===t.event&&$("#viewerFrame").height(t.height)}}window.addEventListener("message",receiveMessage,!1),$("#viewerFrame").load(function(){document.getElementById("viewerFrame").contentWindow.postMessage(JSON.stringify({event:"establishCommunication",message:"Hello, world!"}),"https://viewer.dunkelmann.eu")}),requestJSON=function(e,t,n){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){var t=JSON.parse(s.responseText);if(3===e){var a=t.headers["Last-Modified"][0],i=Math.floor(Date.parse(a)/1e3);n(t.body,i)}else if(5===e){a=t.versionInfo[0].headers["Last-Modified"][0],i=Math.floor(Date.parse(a)/1e3);n(t,i)}}},s.open("GET",t,!0),s.send()},Vue.component("lm-annotation",{props:["lm"],template:'<span class="annotation">Zuletzt ge√§ndert am: <abbr :title="lm.unix">{{ lm.text }}</abbr></span>'});var app=new Vue({el:"#teamspeakApp",data:{ts3channels:[],ts5channels:[],ts3lastModified:{key:0,unix:0,text:""},ts5lastModified:{key:1,unix:0,text:""},isLoading3:!0,isLoading5:!0,browserPlatform:"win"},created:function(){this.browserPlatform=this.getPlatform(),this.request()},methods:{request:function(){requestJSON(3,window.GLOBAL_ENV.TEAMSPEAK3_ENDPOINT,this.pushAll3Elements),requestJSON(5,window.GLOBAL_ENV.TEAMSPEAK5_ENDPOINT,this.pushAll5Elements)},pushAll3Elements:function(e,t){this.ts3lastModified.unix=t,this.ts3lastModified.text=parseUnixTime(t),e.versions.forEach(e=>{this.push3Element(e)}),this.isLoading3=!1},push3Element:function(e){app.ts3channels.push({channel:e.channel[0].toUpperCase()+e.channel.substring(1),version:e.version,timestamp:e.timestamp,time:parseUnixTime(e.timestamp),download:getDownloadButton(e.channel)})},pushAll5Elements:function(e,t){this.ts5lastModified.unix=t,this.ts5lastModified.text=parseUnixTime(t),e.versionInfo.forEach(e=>{this.push5Element(e)}),this.isLoading5=!1},push5Element:function(e){app.ts5channels.push({channel:e.platformName[0].toUpperCase()+e.platformName.substring(1),version:e.platformInfo.version+"-"+e.platformInfo.version_string,timestamp:e.platformInfo.timestamp,time:parseUnixTime(e.platformInfo.timestamp),download:{class:"btn btn-primary",onclick:"window.open(decodeBase64(TS5_URL), '_blank').focus();"}})},getPlatform:function(){return-1!=navigator.userAgent.indexOf("Win")?"win":-1!=navigator.userAgent.indexOf("Mac")?"osx":void 0}}}),video=new Vue({el:"#vid",data:{poster:"",v_hidden:!0}});jebaited=function(){video.v_hidden=!1,video.$el.play();for(var e=document.querySelectorAll("div,table,p,code,tr,td,th"),t=0;t<e.length;t++)e[t].className+=" special";var n=document.querySelectorAll(".bg-primary,.accordion-button,.btn-primary,.btn-danger");for(t=0;t<n.length;t++)n[t].style.setProperty("background-image","url(assets/special/rainbow.gif)","important")},getDownloadButton=function(e){return"beta"==e.toLowerCase()?{class:"btn btn-primary",toggle:"modal",target:"#modalBeta"}:"alpha"==e.toLowerCase()?{class:"btn btn-danger cursor-not-allowed",onclick:"jebaited();"}:{class:"btn btn-primary",onclick:"window.open(decodeBase64("+e.toUpperCase()+"_URL), '_blank').focus();"}},window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?video.poster="assets/thumbnails/gray.png":video.poster="assets/thumbnails/white.png",window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{const t=e.matches?"dark":"light";video.poster="dark"===t?"assets/thumbnails/gray.png":"assets/thumbnails/white.png"});